global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'prometheus'
    scrape_interval: 2s
    static_configs:
      - targets: ['localhost:9090']

  - job_name: 'node_exporter'
    scrape_interval: 2s
    static_configs:
      {%- for host in groups['node_exporter'] %}

      - targets: ['{{ host }}:9100']

      {%- endfor %}

  - job_name: 'node_controller'
    scrape_interval: 5s
    static_configs:
      {%- for host in groups['ncs'] %}
      {%- for port in groups[host] %}

      - targets: ['{{ host }}:{{ port }}']

      {%- endfor %}
      {%- endfor %}